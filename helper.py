# from tensorflow.examples.tutorials.mnist import input_data
import matplotlib.pyplot as plt
# X = input_data.read_data_sets("./data_mnist/", one_hot=True)
# image = X.train.images[0]
# plt.imshow(image.reshape(28, 28), origin="upper", cmap="gray")
# plt.axis('off')
# plt.savefig('mnist_example',  bbox_inches='tight', pad_inches=0)
#
# new_image = 1- image
# plt.imshow(new_image.reshape(28,28), origin="upper", cmap="gray")
# plt.axis('off')
# plt.savefig('mnist_example_changed_background',  bbox_inches='tight', pad_inches=0)
#
# import numpy as np
#
#
# def random_mask_mnist(width_window, margin=0):
#     margin_left = margin
#     margin_righ = margin
#     margin_top = margin
#     margin_bottom = margin
#     start_width = margin_top + np.random.randint(28 - width_window - margin_top - margin_bottom)
#     start_height = margin_left + np.random.randint(28 - width_window - margin_left - margin_righ)
#
#     return np.concatenate([28 * i + np.arange(start_height, start_height + width_window) for i in
#                            np.arange(start_width, start_width + width_window)], axis=0).astype(np.int32)
#
#
# def data_with_mask_mnist(x, width_window=10):
#     h = width_window
#     if width_window <= 0:
#         h = np.random.randint(8, 20)
#     mask = random_mask_mnist(h)
#     x[mask] = 1
#     return x
#
# image_with_patch = data_with_mask_mnist(new_image, 13)
#
# plt.imshow(new_image.reshape(28,28), origin="upper", cmap="gray")
# plt.axis('off')
# plt.savefig('mnist_example_with_patch',  bbox_inches='tight', pad_inches=0)

#
# from processing_images import DatasetProcessor
# import matplotlib.pyplot as plt
#
# d = DatasetProcessor('svhn')
# data_train, data_test = d.load_data()
# data_train['X'] = d.reshape_data(data_train['X'])
# data_test['X'] = d.reshape_data(data_test['X'])
# data_train, data_test = d.mask_data(data_train, data_test)
#
# plt.imshow(data_train['X'][0].reshape(32, 32,3).astype('uint8'), origin="upper")
# plt.axis('off')
# plt.savefig('svhn_masked_example',  bbox_inches='tight', pad_inches=0)

import numpy as np

# data = [0.0052325632, 0.008187881, 0.014886782]
# labels = ['metoda analityczna', 'ostatnia warstwa', 'imputacja']
# pos = np.arange(len(data))
#
# plt.bar(pos,data,color='lightsteelblue', width=0.3)
# plt.xticks(pos, labels)
# plt.xlabel('Metody', fontsize=12)
# plt.ylabel('Średni koszt', fontsize=12)
# plt.title('Porównianie średniego kosztu - autoenkoder fully-connected', fontsize=13)
# plt.savefig("Porównianie średniego kosztu")
# plt.show()


# data = [0.9255, 0.9281,0.935, 0.89641]
# labels = ['pierwsza warstwa', 'ostatnia warstwa', 'imputacja', 'uśredniony koszt']
# pos = np.arange(len(data))
#
# plt.bar(pos,data,color='lightsteelblue', width=0.3)
# plt.xticks(pos, labels)
# plt.xlabel('Metody', fontsize=12)
# plt.ylabel('Precyzja', fontsize=12)
# plt.title('Porównianie precyzji - klasyfikator konwolucyjny', fontsize=12)
# plt.savefig("Porównianie precyzji klasyfikator konwolucyjny")
# plt.show()

results = {
    'metoda analityczna': [0.06148685237806945, 0.0359700387224503, 0.030952409831362496, 0.026120464056209856, 0.02319152607681171, 0.021066915788129404, 0.019535421925066722, 0.01849722003778909, 0.01769804143118081, 0.016998552438630632, 0.0164428479737484, 0.01597021658914608, 0.015499900664366583, 0.015135327626206197, 0.01481048149036133, 0.014504851668214424, 0.01425540962769315, 0.014033935413337004, 0.013812702865804934, 0.013640545387736092, 0.013456725158725407, 0.013304966286137023, 0.01317887455745404, 0.013027460828241355, 0.01291959144920978, 0.01277306565540009, 0.012681132417748984, 0.012592111685995243, 0.012497978130999489, 0.012408690702720904, 0.012309248216571644, 0.012240113768557452, 0.012168264892537741, 0.012094935167004052, 0.01201746034911889, 0.011957157134350575, 0.011910874125514097, 0.011844853028151987, 0.011784136963182056, 0.011735732307195733, 0.011680396744272346, 0.011619456052754131, 0.01158369876708883, 0.0115280805385484, 0.011489849793480772, 0.011459231907902968, 0.01141830061576454, 0.011360966484468946, 0.011335433024926083, 0.011284463154206245, 0.011234443414657094, 0.011169046172232511, 0.011129171641736494, 0.011071998260620379, 0.01101130752187825, 0.010968382274070635, 0.010918558498235188, 0.010860015452775467, 0.010807216991437328, 0.010752790456266946, 0.01067875969474127, 0.010629321871340552, 0.010579598933128733, 0.010519263793186342, 0.010446644349108266, 0.010395650286769562, 0.010325016104751748, 0.010266701720125879, 0.010209086988060556, 0.010149595056084766, 0.010094120521727208, 0.010031362057135498, 0.009970973464264616, 0.009910098271069308, 0.009850776990673943, 0.009813880353810416, 0.009749198998666095, 0.009686470503904731, 0.009647304272957848, 0.009589871442611128, 0.009550014189287274, 0.009492897403635717, 0.009438428989849005, 0.009387386170767759, 0.009337112761825774, 0.009283035286139519, 0.009239664287723782, 0.009198035490270855, 0.009142942299981785, 0.009093628093660988, 0.009045569392027414, 0.00899383991499181, 0.008953259907103425, 0.00889820334576374, 0.0088625082337407, 0.008799641096598022, 0.008773769910107946, 0.008719297270133345, 0.008669567217983142, 0.008630515895870636, 0.008593673425877295, 0.008543220044539784, 0.008505577200371013, 0.008460753616834616, 0.008413067861103449, 0.008368469615346548, 0.00833248232824162, 0.008278632247592815, 0.008249077974678786, 0.008204388583991872, 0.008143244069980347, 0.008103912852366257, 0.008056433349891161, 0.008031577691522549, 0.007983632319594914, 0.007948465759153624, 0.007902436775325584, 0.007854134754556404, 0.007814692901458257, 0.0077721712291153955, 0.007746237395732415, 0.007688569782108797, 0.007652479827803005, 0.007609686838642925, 0.007570292244473423, 0.007534223820632529, 0.007496704922596533, 0.007450083714646392, 0.007418235349745356, 0.0073715932873252244, 0.007335364677085692, 0.007297822961646617, 0.007261220302337367, 0.007236565493602344, 0.007197861420370127, 0.007146467153867652, 0.007127105643294049, 0.007070421073173755, 0.0070495763869481256, 0.007012831821291771, 0.00699112982932604, 0.006952721330665737, 0.0069113036534153745, 0.006878332034343197, 0.0068419020849565205, 0.006826982691415669, 0.006790755475991611, 0.006763360490729735, 0.006737866698047612, 0.006695958867027263, 0.006662323151534039, 0.006653152452293909, 0.0066103540909529706, 0.006578987278369482, 0.006562746775567497, 0.00652197295121146, 0.006496345579333612, 0.006466073461085107, 0.006442945284120591, 0.006420241152744077, 0.006394881199464219, 0.006380129286236584, 0.006338258283115203, 0.006322105069849661, 0.006289284095727558, 0.006266187338702754, 0.006235067531514189, 0.00621058530097218, 0.006192184941858331, 0.006175515959657321, 0.006138365431141208, 0.006124757231366023, 0.006108346403868082, 0.0060767072607460625, 0.00605985813430479, 0.006035955858062324, 0.006016161996433219, 0.005984407081458462, 0.00597576016063636, 0.005944532969461297, 0.0059313067019298, 0.005914353371442787, 0.0058844113159746934, 0.005868294605892044, 0.005841284915501289, 0.005842821740320904, 0.005810797588012861, 0.005800440233109716, 0.005775072722998258, 0.005759519311828198, 0.005731078343437735, 0.0057101964986339925, 0.005705206160573451, 0.005688801375288209, 0.005665649687578604, 0.005642067867074252, 0.005619657224822655, 0.00561460059643555, 0.005588431051976727, 0.005567735914310074, 0.00555712072399897, 0.005542781440881585, 0.005525969138544603, 0.005508284475892886, 0.005499874788083839, 0.005471877249042321, 0.005459167695592339, 0.005440951421221542, 0.0054313082752664756, 0.005416338871383868, 0.005391225486839834, 0.0053914088275548114, 0.0053664536000694535, 0.0053638175029060405, 0.005333367030150382, 0.005327199665966148, 0.0053130094023211075, 0.005304439390962889, 0.005279284201798759, 0.005264932813656292, 0.005247922822382037, 0.005241777976634408, 0.0052213256417560075, 0.0052212443795245965, 0.005193367243199083, 0.005182706241900312, 0.0051637304330415966, 0.005167330897926018, 0.005143203969114613, 0.005128820678295093, 0.005125330723128233, 0.00510470731789951, 0.005098322889419561, 0.005082624634007931, 0.005074688534298966, 0.005057560346101229, 0.0050454489456877825, 0.005032362168919342, 0.005022369835274218, 0.005010821590930813, 0.004999532365935125, 0.004982445515069907, 0.004975060186141775, 0.004967737304885916, 0.004958653566400424, 0.004946699575764995, 0.00493207760507564, 0.0049188924049123756, 0.004914388716778131, 0.00490385031124861],
    'imputacja': [0.06563232278145581, 0.03718555232724641, 0.034072544555829205, 0.03075170452349816, 0.028630074516927544, 0.027229716064575388, 0.026093827528018195, 0.025122027724929268, 0.024286385534528526, 0.023624437404698904, 0.022998040542006493, 0.02239850419546381, 0.0217828669794537, 0.0212557641279746, 0.020831069296466595, 0.020489720991954674, 0.020161849460689236, 0.019872380461764975, 0.019696592562533786, 0.019450531856127613, 0.019255411549882227, 0.019070661581220047, 0.018970680577036457, 0.018877921592361784, 0.01871592168966189, 0.018687753890433954, 0.018546804193758575, 0.018404602176131414, 0.018314757759490933, 0.018270308523719678, 0.018157751988988193, 0.018126276512527285, 0.018021860989341915, 0.017988651261227995, 0.017928471098132476, 0.01797949849292896, 0.017853705330651008, 0.017781571819033903, 0.017885528343303588, 0.017803872546248302, 0.017774619018969075, 0.017720153689714056, 0.017701128388216178, 0.017713895904570297, 0.01763752092443606, 0.017587413062689537, 0.01749789193207539, 0.017615086014129925, 0.01749224500888926, 0.017456233033062554, 0.01742453934306038, 0.017458726186847382, 0.01740778813396642, 0.01732992676842407, 0.017338943553869467, 0.01734511447773338, 0.01725032106280431, 0.017242498078944034, 0.017293957256136312, 0.017222986609715104, 0.017276654269316422, 0.01724188617182347, 0.017242402624343203, 0.0171722655788463, 0.017126450704343453, 0.017221596718649788, 0.01710943116484442, 0.017173737376425264, 0.017119263356271806, 0.0170447502374146, 0.017080024992819437, 0.01713923170590151, 0.01710249003937969, 0.017103985797644217, 0.016975728030575656, 0.017033334344417308, 0.017081927933119783, 0.017095752790075868, 0.01701646118844416, 0.01695404615582805, 0.01699780252880316, 0.01700529624839184, 0.01697917176438745, 0.01694425076953156, 0.017006094675897095, 0.016951806165659594, 0.017003042389214802, 0.016991436554116824, 0.016983723484751648, 0.016841298061378553, 0.016854466413981493, 0.01682138613211609, 0.016922644825220733, 0.016871242266803182, 0.0168163648625452, 0.016886992895015114, 0.01689631933274834, 0.016966920019679282, 0.01687395340861694, 0.016850729457756484, 0.0167726445433546, 0.016844278592854842, 0.016863292629577923, 0.01678585603169672, 0.016815645267863836, 0.016821255352309057, 0.016926560519486492, 0.016858293389743227, 0.016860527436360632, 0.01671587307617606, 0.016782058582872118, 0.016818654167273964, 0.016822214947408445, 0.016814735320172292, 0.016790479703506018, 0.01667727575105061, 0.0166903369245797, 0.01665755590191924, 0.016638563749650375, 0.01662506597556772, 0.01667697403180967, 0.01672912630056301, 0.01660953444993607, 0.016594907736169374, 0.016666387509212018, 0.016670248147026483, 0.016691939781687728, 0.016666972914296477, 0.016680352241277903, 0.016823382438859783, 0.01673023985228279, 0.016624591380522538, 0.016564738037925523, 0.016456043626354167, 0.016611703272531628, 0.016579320420087147, 0.016593033487976847, 0.016521323493945306, 0.01667268957175115, 0.016481862597523107, 0.016568874848119662, 0.016456063377114753, 0.016579823955520556, 0.01650462040679835, 0.016473711281798007, 0.016539441135400804, 0.016472522050090248, 0.016420785588135332, 0.01654757073255336, 0.01657511572634348, 0.016696437356323524, 0.016642223953619615, 0.016540852713597044, 0.016446877891095887, 0.016420791027536213, 0.016388727109163687, 0.016451098656930178, 0.016538207233819473, 0.016415292513150204, 0.01644573641704597, 0.01649222163888989, 0.01652680984909654, 0.016446009175299002, 0.016471613489082722, 0.016338086306476342, 0.016385669408016973, 0.01651681427398265, 0.016461867042215448, 0.0164878580391806, 0.016438156315391153, 0.016411862661357322, 0.016461723435310185, 0.016327107316522715, 0.01635601094406753, 0.01640917714446679, 0.016378988770982716, 0.016339327190266498, 0.016530109753743315, 0.01644683160902596, 0.016431020597718022, 0.016493012200568275, 0.01651871850989473, 0.016515278780011067, 0.016374031511136485, 0.016283092625673352, 0.016381866302952706, 0.01640228548318113, 0.01643683401189042, 0.016408878775385053, 0.016425301787054234, 0.01642354849370346, 0.016344798590046842, 0.01650985724881413, 0.016439801524366155, 0.016479757985228084, 0.01627371813646573, 0.01630477701791923, 0.01633242839064809, 0.016403852532616663, 0.016312063552387172, 0.016353653261396813, 0.01632486250819649, 0.0164393301504611, 0.016284295152851118, 0.016388059907069166, 0.016236554533113075, 0.016229955105455777, 0.0162888971548766, 0.016263481822597757, 0.01633116268206982, 0.016263657656083008, 0.0164360371651399, 0.016549291093513906, 0.016458508640970076, 0.01639106582169344, 0.016333277450009263, 0.016263562875850793, 0.016200511494046457, 0.016155474291240517, 0.01632925235298793, 0.01636030074378109, 0.016298378433932455, 0.01623552777762151, 0.016277216872519124, 0.016222658174652366, 0.01620217631175264, 0.01623925124105322, 0.016370166369580486, 0.01635017438018662, 0.016190316201739524, 0.016332916901322197, 0.01633958517204064, 0.01645288972034443, 0.016525935162643755, 0.01628947942664064, 0.01638279553194887, 0.01621143956591697, 0.01614336170390578, 0.016197722130894175, 0.016173850225633807, 0.016207371378692607, 0.01615002657892887, 0.016342118023585733, 0.016224999288671646, 0.01616033601950815, 0.016131096725526664, 0.016297773245561593, 0.016104051548384814, 0.016197882614361947, 0.01638240029556163],
    'pierwsza warstwa': [0.06219353077974392, 0.039077032749932496, 0.0350128882439922, 0.029452698036369122, 0.024741222127855726, 0.022190389788261808, 0.02057369691737178, 0.019436016505339094, 0.018615954008053152, 0.018037913516770976, 0.01761858372995684, 0.017256492227359272, 0.01698154442628132, 0.016671219249760106, 0.01651052389254878, 0.016347587356892467, 0.016229259780455245, 0.016137236088505653, 0.015996615892456142, 0.015834938857283733, 0.015731841764858423, 0.01552363048276156, 0.015512234387145192, 0.015376935200169422, 0.015420564632468159, 0.015375039574925434, 0.015473037580845658, 0.01530643577803451, 0.015325745905947907, 0.015268776786965735, 0.015255072832810102, 0.015341429375936045, 0.015197431828015688, 0.015335000627506113, 0.015086950292990774, 0.015007500317732654, 0.015106789456578503, 0.015099369647573328, 0.015221528455233408, 0.014971722663316239, 0.014883896158151631, 0.014972726059849867, 0.015120634268123627, 0.015136370680384918, 0.01500526363001887, 0.015002825887216747, 0.014852981846367592, 0.014733103614591054, 0.01511041992002441, 0.014835137607176313, 0.014567473005585814, 0.01458881287895169, 0.014737162182846987, 0.01458125872639408, 0.014527018165716747, 0.014648968282310732, 0.01475874432910134, 0.014759027819789954, 0.01480374565593057, 0.014703904769716218, 0.014842570784292483, 0.014857472577571383, 0.01509680703598941, 0.014631313368313803, 0.014338807479345062, 0.014585111194807382, 0.014569797695151447, 0.014653959344070712, 0.014709534717678191, 0.014614479799513143, 0.014394290851509336, 0.014552731164519668, 0.014324856981661114, 0.01453380716576461, 0.014488306059149702, 0.014464729122938946, 0.014517792509229067, 0.014645770141189188, 0.014541975226864757, 0.014452226597672639, 0.014921172042794707, 0.014781840890429143, 0.014863375243671213, 0.014543626280729166, 0.014514450912989408, 0.014712673146819764, 0.014410700465794284, 0.01472630174624559, 0.014427744140534101, 0.014635004484820005, 0.014595120197662929, 0.014846919975064618, 0.014567355560279768, 0.014461753275180376, 0.014757708629009957, 0.01511528488027411, 0.014522424047949428, 0.014545710488494672, 0.014606430315617494, 0.01430495259730412, 0.014488473772022514, 0.014544465183361723, 0.014481578638063737, 0.014556721182446818, 0.014561130269511892, 0.014293375605016912, 0.014088850891232768, 0.014184134553714598, 0.01421073985928984, 0.01441630215315762, 0.014425229672581062, 0.014317694804235443, 0.01446223745558398, 0.01463667422151399, 0.014527514894580745, 0.014730972663973208, 0.014641089638103151, 0.014662836091777222, 0.014160441338790448, 0.01434112072741229, 0.014424188524415247, 0.014492701861586712, 0.014058607270479272, 0.01428910029013408, 0.014345020116485733, 0.014146524315593684, 0.014196423668418692, 0.014468042441232865, 0.014307376072114297, 0.014515765247664852, 0.014287574415130929, 0.014269676794567957, 0.014353080521466707, 0.014423116597068323, 0.014549488177885138, 0.014329313659418171, 0.014334876514207983, 0.01423399272560206, 0.01423775516472089, 0.014240064992156309, 0.014076688924286086, 0.014161211583759024, 0.014285518285819481, 0.014376514578266318, 0.014372695789252852, 0.014535675124548229, 0.01468278510047164, 0.014477642755023052, 0.014568417510874267, 0.014633445551660133, 0.014400218544057349, 0.014299180422615741, 0.014225936515367351, 0.014203236313651687, 0.01423153692229767, 0.014282782295365342, 0.014645771180931154, 0.014313204047010997, 0.014341090704998538, 0.014435741666604671, 0.014283499678291112, 0.014459399940127265, 0.01399927404064065, 0.014055584364367933, 0.014334377222309567, 0.014088769384786677, 0.014054541856622946, 0.01382328077014514, 0.014071908077968846, 0.013867942211939167, 0.01375346446390306, 0.014049372183672902, 0.013796661436184807, 0.013897889493221939, 0.01388107633328757, 0.013796971682610903, 0.013680362170811512, 0.014164072952566102, 0.014474285466160638, 0.01465088625062296, 0.01497675759806726, 0.014613163025401386, 0.014575665956525711, 0.014649983219004414, 0.01465021621661393, 0.014710545110515167, 0.014474228187111814, 0.014247170306863621, 0.014378466430891032, 0.014247479938551766, 0.014179323432366423, 0.01393262660553694, 0.013904554829027447, 0.014001948080254378, 0.01432367075533889, 0.01413698450199245, 0.014151826054204746, 0.013927411964559998, 0.014015753857565911, 0.014019296689954292, 0.013779056212963478, 0.013490992288156147, 0.013502873383826719, 0.013616577513966974, 0.013963620040708842, 0.0138926743350845, 0.013825196928937722, 0.013775743622163676, 0.013668854867256702, 0.01395455515716871, 0.013887191143611118, 0.014137931101943547, 0.013842886997922405, 0.01392609153346216, 0.01395305527679891, 0.014088614613936653, 0.013839658313974027, 0.014049217522326463, 0.01400741512916453, 0.013963432153155627, 0.014018498078136075, 0.013565582842311288, 0.013629254595538097, 0.013645730954968956, 0.01405321620079462, 0.013700004390574238, 0.013568607220757966, 0.013936550486550967, 0.01396481779092821, 0.014343551857715714, 0.01482525615539831, 0.01428572186816384, 0.01473344469115537, 0.014704901973334194, 0.014195783828126052, 0.01413586908220655, 0.01389053293392149, 0.013673741968914572, 0.013994230525578969, 0.014087783057802075, 0.014315714857977955, 0.014201494947518194, 0.014263492616433412, 0.014313708753373833, 0.01428451174946027, 0.013959754918668337, 0.014026005655891405, 0.014302663173314023, 0.01425088103643778, 0.013939601442927323],
    'ostatnia warstwa': [0.06321031053369482, 0.0366811703834184, 0.03238450702631085, 0.026665123086314264, 0.022905910394140395, 0.020420077836902095, 0.018782755490110555, 0.017630877310455678, 0.016698057341527052, 0.0160034104012933, 0.015435911923195902, 0.014926439989249767, 0.014483131131111743, 0.014101570631497744, 0.013772364713390368, 0.013459681369563754, 0.013265660829512495, 0.013062074926830352, 0.012853528974671026, 0.012664775301217686, 0.012521652921132215, 0.0124046264077527, 0.01227576896977612, 0.012138430025901242, 0.012030869287604572, 0.01195530439439697, 0.011846428170010916, 0.011757948990950276, 0.011691533554913487, 0.011597322989623815, 0.011507252912114052, 0.011475777151594339, 0.011434963779638893, 0.01137746062901682, 0.011267897812812237, 0.011216382498227328, 0.011197195562931934, 0.011130172065410403, 0.011087787244360508, 0.011050377430327073, 0.01105106150247894, 0.010973337752586264, 0.010971154698861353, 0.010956315406109179, 0.010950756697276904, 0.010900550268208815, 0.010856233391915129, 0.01082429803834146, 0.010822497587976272, 0.010779185833168737, 0.010737912403040145, 0.010698682970093071, 0.010678147153367264, 0.010700554207479094, 0.010649484584413737, 0.010571827069011639, 0.010606096291478736, 0.010601193783967403, 0.010581126574283777, 0.010537448068115778, 0.010505024289519323, 0.01055904380799346, 0.010519396490932413, 0.010483255526387025, 0.010409454213362078, 0.01045216868140402, 0.010452925109405318, 0.010399938884654165, 0.01036144550065743, 0.010409715533369286, 0.010326247906249463, 0.01035525319974206, 0.010288620141591785, 0.010295357708022328, 0.010318946517240668, 0.010256133204904993, 0.010322476083974378, 0.010323758284768418, 0.010338644020593313, 0.010328051403199558, 0.010367125294434733, 0.010301052829049034, 0.010247191941155266, 0.010307818578558349, 0.010241057800738373, 0.010258635474050176, 0.010253751354467674, 0.010276960060477465, 0.01024186096291846, 0.010235112647789426, 0.010214095811627381, 0.01019311513387456, 0.010100816573288478, 0.010196615432793484, 0.010139992301231977, 0.010221163568773216, 0.010148593882148668, 0.01011937719686293, 0.010092367855040519, 0.010087840812014063, 0.010111138807355976, 0.01020867838518861, 0.010184517439793062, 0.010109874448057034, 0.010060563410292959, 0.010125151737262436, 0.0101480810004216, 0.010134071114389562, 0.01005730675685201, 0.010069815530869958, 0.010085341866465331, 0.010144611528930411, 0.010047513571469172, 0.010027570427179649, 0.010048986441858018, 0.009994401723337256, 0.01005396967519582, 0.009987794912319383, 0.010038028976948318, 0.009950351118564398, 0.010019694402384571, 0.010042827586156594, 0.010062517097915877, 0.010056348390686429, 0.010039522515867899, 0.010087444849216896, 0.010035177048217674, 0.010023338609614666, 0.009974077156917284, 0.009964388202142937, 0.009976263752161624, 0.009948987402650718, 0.010048461039859598, 0.0100089317205014, 0.010105172868241254, 0.010059704167098327, 0.009980741804259655, 0.01000114570765369, 0.010105023136724555, 0.00999336307965939, 0.009994696366586597, 0.009996041172532076, 0.009998403908088543, 0.00996384813859018, 0.0101253725176328, 0.00998575398557504, 0.009976912750640278, 0.01001197499427966, 0.009982287346540459, 0.00996821464502336, 0.009960868505368549, 0.01001663764882334, 0.009989609423053382, 0.009920350674917104, 0.00991566207073412, 0.010064564219202165, 0.01009022651784495, 0.010023302097758225, 0.010064247854669797, 0.00996039938496055, 0.009914035918635595, 0.00999776092471774, 0.010048101170420022, 0.00994069545721685, 0.010017766671448217, 0.009954507786312223, 0.009924170379532334, 0.009915958940917766, 0.009945934322338477, 0.009952660711271833, 0.009921218051734501, 0.009894961383891952, 0.009998457912329641, 0.009968389439850837, 0.00988078017299507, 0.009858768334670797, 0.009925240160717398, 0.009987570628376376, 0.009978232729629255, 0.010002075624570892, 0.009941940211037193, 0.00990537480246254, 0.009965633292605492, 0.00993480329804027, 0.009911361437212845, 0.009883203607147974, 0.010013177058506623, 0.009950320459186719, 0.009884373301139256, 0.009848435367083522, 0.009821649970935617, 0.00992036203401677, 0.009918146732027996, 0.009901320684280537, 0.009933607255426323, 0.009919761731023699, 0.009885145935129127, 0.009975204971750138, 0.009959399607466215, 0.009880274325518135, 0.009833813466053625, 0.009898476789968915, 0.00985449691312832, 0.009886637029191426, 0.009905401464959345, 0.009841776857905013, 0.009862358448213798, 0.009905131418817395, 0.009795369012270457, 0.009864431108229894, 0.009829589219956861, 0.009861071399988756, 0.009840772856391178, 0.009783784616565087, 0.0098022524423559, 0.009869511818190185, 0.009852838782730217, 0.00976151512551953, 0.009797240070222386, 0.009872672390366218, 0.009985248189055218, 0.009900685844832339, 0.009801762288043815, 0.009803067978983258, 0.009749046135997363, 0.00978183070776661, 0.009783568542680516, 0.009831776375729457, 0.009894664606948983, 0.00982934752385955, 0.009853090394865092, 0.009882270985709046, 0.009848776326012798, 0.009827008793440596, 0.009880803591041577, 0.009883114390456842, 0.009912338661847417, 0.009911312412674407, 0.009836211959409666, 0.00980369651004915, 0.00985161596269491, 0.009888870907216674, 0.009955539692266995, 0.009992203078361725, 0.009881296068781225, 0.009780441824459536, 0.0098187541036202, 0.009853662687708322, 0.009937924121498923, 0.009974316814187936],
    'uśredniony koszt': [0.06161448429962046, 0.035496570174262464, 0.030049357678181773, 0.02586435495601475, 0.023305569581331835, 0.021543265939435386, 0.02045619012451838, 0.019666305755083997, 0.0190230429257083, 0.01848893304061626, 0.018092104911422564, 0.01769310107066516, 0.01740132719365071, 0.017124294732698393, 0.01690118550512684, 0.01668950746527616, 0.01650867723492305, 0.01633576655758239, 0.016181574801549022, 0.016042373053148404, 0.015946032972713634, 0.015813985358104025, 0.015730325720241516, 0.015630946378630172, 0.015546147753858593, 0.015456411051883756, 0.01538929008641329, 0.015309937722217703, 0.015262148743094194, 0.015188540986872456, 0.015127011777549045, 0.015065066071879877, 0.015003506175531844, 0.014972558358903189, 0.014921914710206813, 0.014892289793385546, 0.014836963816904771, 0.014844602859677689, 0.014769048509171734, 0.01475570720378678, 0.014720061120638955, 0.014668075568384217, 0.014653424814785803, 0.014622436636870205, 0.01459614277358695, 0.014566711749669004, 0.014554191289666923, 0.014524096824723156, 0.01449827455218374, 0.014480247066873403, 0.01446395804747783, 0.014467275336089873, 0.014433694102425168, 0.014405068191152165, 0.014397922701639263, 0.01435096369247463, 0.014355894944677183, 0.014313412922390056, 0.01431346743023923, 0.01430098406484782, 0.014285145546456017, 0.014280892261309382, 0.01424700148702882, 0.014248191392021005, 0.014193043032524472, 0.01421121521760754, 0.014211869851726176, 0.014200714565336496, 0.014167046266563487, 0.014145494921174121, 0.014164377139432397, 0.014125907967112118, 0.01413543981080387, 0.014108057042781147, 0.014091866095230521, 0.014088810207940231, 0.014079025914031705, 0.014079646920791814, 0.014071616422215842, 0.014059810826557063, 0.014040234447722524, 0.014020549253765516, 0.014011124440613046, 0.014010542602526573, 0.014030403912943442, 0.01400108761734159, 0.01399024736734673, 0.013998588071149428, 0.013976522210694857, 0.013954126552545288, 0.013946251031900381, 0.013933529030006895, 0.013944161530015979, 0.013940344502817626, 0.013898429906427236, 0.013903199645177796, 0.013899143273498737, 0.013888073340275165, 0.013875638832998428, 0.013887729608519946, 0.013871951244459233, 0.013892840976773721, 0.013849184867883658, 0.013853365849222168, 0.013845207797400264, 0.013803044794836407, 0.013834653920965645, 0.013867292015426233, 0.013830029665860017, 0.013839931407242979, 0.013831769798180833, 0.013819723958160394, 0.013802006836369096, 0.013805315559849195, 0.01380276241327817, 0.013816321135321859, 0.013820904107575714, 0.01381525539763801, 0.013795302740631059, 0.013766631346339049, 0.013779815987871398, 0.01377472332196269, 0.013773891936046558, 0.013771724287633014, 0.013765018844241937, 0.013731761079832339, 0.0137260478744511, 0.013725195988596388, 0.013760171650677954, 0.013721653626748166, 0.013747609395000377, 0.013730356307121317, 0.013733183404558681, 0.013723970802849955, 0.013727489102098384, 0.013730621053181303, 0.013697697732237637, 0.013694548006879645, 0.013741604530613552, 0.013736937517068231, 0.0136910516864103, 0.013676414904818893, 0.013663078342782327, 0.013713268839620808, 0.01366377620371243, 0.013661386102559403, 0.013679014386585345, 0.01365907221373357, 0.013651665135333368, 0.013637912627721554, 0.013642035188355045, 0.01363985223546017, 0.01364810857162903, 0.013630367088000419, 0.013642084111521352, 0.013629256709716235, 0.013653434277430819, 0.013653367277499336, 0.013616304684157143, 0.013618645223553646, 0.013635831951175636, 0.013649510101516047, 0.01360532508054976, 0.01363437352604444, 0.013632769490417626, 0.013627697801492823, 0.013636500618016138, 0.013633659405458168, 0.013616003059241075, 0.013603870451181468, 0.01359861793714262, 0.013606379299757436, 0.013606534080365206, 0.013632578062971272, 0.013604950487214695, 0.013599650355379017, 0.013594518917611648, 0.013629764880078636, 0.013608594091090876, 0.013568334695606626, 0.013594474013552191, 0.013563300404866791, 0.01357606743983881, 0.01358381645023233, 0.013604514875445988, 0.013605397000553236, 0.013585094390686371, 0.013585950015925902, 0.013579174703826241, 0.013588517452172754, 0.013603276735750635, 0.01361223830211565, 0.013569090138075654, 0.013573729046062069, 0.013581123248575314, 0.013590794725601624, 0.013549190862440396, 0.013576035829080969, 0.013583489685027716, 0.0135818449238248, 0.013550891319769017, 0.013534122438314214, 0.013555149546671525, 0.01355886990280347, 0.013527939202344182, 0.013537442617387239, 0.013488457478556839, 0.013532922108797519, 0.013543713085431437, 0.013538423706631027, 0.013531994246969886, 0.013529450062345778, 0.013524511639284658, 0.013527409709140016, 0.013510897841274183, 0.013517348957708815, 0.013536689930939146, 0.013566535260046943, 0.013526263165399345, 0.013529176185204625, 0.013511433098053211, 0.013482019008160054, 0.013493222015344985, 0.013488290813015351, 0.013504033648041407, 0.013500276506294056, 0.013496369263319877, 0.013493318896745012, 0.0135066881244601, 0.01348809131266109, 0.013494102593307515, 0.013488900940973698, 0.013473582677369693, 0.013481236455422133, 0.013488273466996874, 0.013442597359557646, 0.013495943563251959, 0.013478281381903205, 0.013493588532519562, 0.013437385949478577, 0.013519479527774596, 0.013500086155452258, 0.013484028752403154, 0.013484369150262078, 0.01346604058430102, 0.013436533242889069, 0.013438139582427958, 0.013490285431669117, 0.013471060862918672, 0.013444225200830294],
}

plt.figure(figsize=(9,8))
for key, data in results.items():
    plt.plot([x for x in range(1, 251)], data, label=key)
    plt.xlabel('epoki')
    plt.ylabel('koszt')
    plt.title('Training loss dla imputacji, metody analitycznej oraz metod losujących - 250 epok')
plt.legend()
plt.savefig('ac_fc_loss_250.png')


# results = {
#     'imputacja': [0.17022855852882043, 0.04972741872739889, 0.04392279953995797, 0.027291383826224515, 0.022156540445868518, 0.020826638255410323, 0.019781178151248396, 0.019033109779521967, 0.018425980912061376, 0.01792138965341382, 0.017494410501317746, 0.017124366588296587, 0.016799535083424345, 0.0165092362075229, 0.016242987730729744, 0.015976445339695985, 0.015741259194281876, 0.015534879226245123, 0.015358730184891421, 0.015197736080784697, 0.015043912010507456, 0.014898116002875444, 0.014754348103924914, 0.014611716330450289, 0.014471347051666405, 0.014338703495215929, 0.014195117402517209, 0.014058476141070015, 0.013927081406359275, 0.013796420091292193, 0.013685514457558508, 0.013570665656070065, 0.0134452709945497, 0.013334628268274277, 0.01323732972640413, 0.013131121319553638, 0.013030454927742706, 0.012941889061923373, 0.012854064738332947, 0.01276435092273652, 0.0126794180701383, 0.012602585773770896, 0.01252649720960885, 0.01245311932374905, 0.012381067869662891, 0.012300690580354524, 0.012221499067639885, 0.012148311907945242, 0.012082590284202641, 0.012021313065916066, 0.011962711139467477, 0.011903608386649498, 0.011840773294393947, 0.011765328917819286, 0.011690070922682937, 0.011613619561635818, 0.011549442658590514, 0.011490902208644817, 0.011430388567700943, 0.01136597263138196, 0.011306261871652805, 0.01125545848438997, 0.011209018186768768, 0.011163866173818487, 0.01111206119668182, 0.011054954083068993, 0.011004612168309636, 0.010955061205327597, 0.010901021241929284, 0.010844344488359447, 0.01079625953603964, 0.010750448052544588, 0.010701030507008498, 0.010644801036347162, 0.010591015430096324, 0.010538568045913627, 0.010492094052272123, 0.0104465573810145, 0.010401087034719132, 0.010353334818456994, 0.010307873213099538, 0.010265523885372146, 0.010223573772575417, 0.010180630818700891, 0.010140375266567518, 0.010101404528932661, 0.010064641363698754, 0.010028861534876865, 0.009985463122669515, 0.009933992250664509, 0.00987526097890138, 0.009824312463156707, 0.009778477061038052, 0.009739548005033604, 0.009703450837731577, 0.009670843560614964, 0.009641247134490964, 0.009613768428326702, 0.009588236140685005, 0.009563001968125887],
#     'pierwsza warstwa': [0.07720478891823436, 0.027811300515660303, 0.023518664517421205, 0.021632018133267383, 0.02043946835751368, 0.019467339970188794, 0.018556308790614325, 0.01779091934699772, 0.017261163180638164, 0.016825206363440894, 0.016462038869430047, 0.016127457333349856, 0.015824754507266524, 0.01553823795507762, 0.015266106106559828, 0.015017114770440192, 0.014796014809056983, 0.014590944410083614, 0.014398398609972291, 0.014195239445607018, 0.013978647109330273, 0.013766036302789912, 0.013556896906984486, 0.013352903234779159, 0.013186217580507635, 0.013021781457469392, 0.012864238046302606, 0.012724123543585226, 0.01259247941507749, 0.012461672187613468, 0.012328577870359455, 0.012193964876788393, 0.012070317827988874, 0.011960886149746598, 0.011859501836263782, 0.011762713912521115, 0.011661836687515546, 0.01156007391063278, 0.011464145066797006, 0.01138159340022065, 0.011279702693026687, 0.011187868817241422, 0.011076061400821433, 0.010995719807018174, 0.010920922282204175, 0.010844763089946866, 0.01077481257670432, 0.010699459354308912, 0.010626786050828679, 0.01056175981018262, 0.01050449383873487, 0.010442163638883303, 0.010388717777319286, 0.010336242905030216, 0.010286603033800596, 0.010236825189312852, 0.010190896376244483, 0.010144955011727958, 0.01009411911325947, 0.010044610731662455, 0.009994581126322623, 0.009941233270675602, 0.00989029605178976, 0.009843491532660724, 0.009795805596244397, 0.009760127073072021, 0.009718132523425814, 0.009679876739532623, 0.009637589121206507, 0.009603360141195293, 0.009564215844946352, 0.009521612648358733, 0.009489020046279169, 0.009453905805005674, 0.009419796611584782, 0.009376825020286252, 0.0093436230495377, 0.00930939112815129, 0.009273413598406296, 0.00923707528101594, 0.009206223671327531, 0.009173760034121164, 0.009143607053338857, 0.009115501174040449, 0.009085868118243584, 0.009057549313865093, 0.009031383140900861, 0.009003793807867736, 0.008984486395636763, 0.00896079682793543, 0.008932573011007885, 0.008914502452737047, 0.008890435737464225, 0.008869096533126277, 0.008846920990683994, 0.008827180727928279, 0.008807309326445611, 0.008788393361123801, 0.00876654829119449, 0.00874616764851645],
#     'ostatnia warstwa': [0.1792080939685341, 0.03883086941466451, 0.029641119681964236, 0.02535562814181632, 0.022514301993587976, 0.020714585959547165, 0.019294933619447528, 0.0181625421314235, 0.017298655058502508, 0.016640711489849167, 0.016114324503891216, 0.015663849143270736, 0.015263883254724098, 0.014927911209871959, 0.014629628877530776, 0.0143615933000209, 0.014097216222863368, 0.013856192495525404, 0.0136075318472041, 0.013389761744195513, 0.013190606908408281, 0.013005900362835466, 0.012836620251162821, 0.012677123446038097, 0.012533898271050153, 0.012404740695099966, 0.01227706788497407, 0.012158259424113511, 0.012041352619897984, 0.011934523479099846, 0.011827892323200973, 0.011727405433722679, 0.011630133058711049, 0.0115373432698584, 0.011452356592532825, 0.011373312177436232, 0.011298850449417214, 0.011232434710309425, 0.011161857415348343, 0.011090357946559834, 0.01103031811075963, 0.010957707741598828, 0.010896327750226777, 0.010835996351118373, 0.01077920983127918, 0.010722779855836624, 0.010672980811905385, 0.01061441042916543, 0.010560030674744491, 0.010513280585146997, 0.010467236168581775, 0.010418645974171692, 0.010379028740694764, 0.010334860738057937, 0.010292114241897913, 0.01025470147998112, 0.010216817863644305, 0.010174616554696172, 0.010132511764990233, 0.01009288299701412, 0.010054748702755294, 0.010016419688916575, 0.009980242583951632, 0.009941444602860791, 0.009906168364975813, 0.009868039308153234, 0.009828920515971125, 0.009794495534287278, 0.009762535227345048, 0.009728167637974535, 0.009697092867193264, 0.009666144594648766, 0.009635874148130911, 0.009605517458758114, 0.009583565535076376, 0.009556091931540977, 0.009527776822781612, 0.009501932650194295, 0.00947598233379495, 0.00945743861217198, 0.009431324437735367, 0.009408117679227116, 0.009391188652953473, 0.009368676087985145, 0.009345874218375861, 0.009321864122069087, 0.009304587855005129, 0.009281794765353384, 0.009260534082049196, 0.009241993710152633, 0.009221156066240771, 0.009204692122056877, 0.009180351123750288, 0.00916365072754929, 0.009146684935576032, 0.009123756872570797, 0.009106808910940296, 0.009090690156442198, 0.009072421664485351, 0.009051357228487756],
#     'uśredniony koszt':[0.12961670864294322, 0.040786616090692715, 0.040546745594600656, 0.04045119685176971, 0.04037061253828662, 0.04028389016954851, 0.04021822369977472, 0.04017549609195832, 0.04014535480337952, 0.04012169814561563, 0.04010312501715042, 0.04008712699641694, 0.04007402753226019, 0.04006271247185955, 0.04005362333961271, 0.040044557277719085, 0.04003681870573546, 0.04003194539900137, 0.040026780724057215, 0.0400194595515043, 0.0400157847645231, 0.04001227542129338, 0.040007152606819585, 0.04000500649005686, 0.040001517887925525, 0.03999695476553174, 0.03999448755952745, 0.0399921040349023, 0.03999210282421004, 0.03999392763007804, 0.03999369621768936, 0.039990412652848036, 0.03998870045653359, 0.03998475096434797, 0.03998136907709713, 0.03997793696129222, 0.03997532319757683, 0.039972463778767744, 0.03997058110137665, 0.03996927547546313, 0.03997013774793405, 0.03997195002037337, 0.03997155740761743, 0.03996946316148467, 0.03996723428084592, 0.03996574279795579, 0.03996483487035599, 0.03996237257974055, 0.03996106481750257, 0.03996035037738381, 0.039959067086411976, 0.039958820112238176, 0.039957951997662305, 0.03995781425892839, 0.03995794168618449, 0.03995652682266334, 0.039959314186315674, 0.039958531798939566, 0.03995842290437947, 0.03995931664726174, 0.03995840370997565, 0.039959071273434496, 0.03995868534495708, 0.03995784887854863, 0.039957997876612084, 0.03995847867588803, 0.039959770838947084, 0.03996036150935763, 0.039960263057424644, 0.039959481482415446, 0.039960363370376964, 0.03995977545518548, 0.03995796664627982, 0.03995737419343113, 0.03995745334907573, 0.03995720154730723, 0.03995603564525105, 0.03995611640774548, 0.039956909970450545, 0.03996243341404545, 0.03996421816897819, 0.03995838289083802, 0.0399616290775884, 0.03996862117163154, 0.03997116637949181, 0.039971608927070766, 0.03997602703302865, 0.03997828416441775, 0.03998526070480486, 0.03998547500383639, 0.03998169013924175, 0.039977642466092755, 0.03997428063330329, 0.03997338661132231, 0.039972420322286345, 0.03997345156111376, 0.039971736101241245, 0.0399689973473705, 0.039969524351843644, 0.0399692199212722]
# }
#
# plt.figure(figsize=(9,8))
# for key, data in results.items():
#     plt.plot([x for x in range(1, 101)], data, label=key)
#     plt.xlabel('epoki')
#     plt.ylabel('koszt')
#     plt.title('Training loss dla imputacji i metod losujących z 5 próbkami')
# plt.legend()
# plt.savefig('Training_loss_autoencoder_100_cnn_5.png')





import sys
from PIL import Image

for i in range(1000):
    images = [Image.open(x) for x in ['original_data_cnn/'+str(i)+'.png',
                                      'image_with_patch_cnn/'+str(i)+'.png',
                                      'result_cnn_3imputation_100_1_0.0/'+str(i)+'-imputation.png',
                                      'result_cnn_3first_layer_100_10_0.5/'+str(i)+'-first_layer.png',
                                      'result_cnn_3last_layer_100_10_1.5/'+str(i)+'-last_layer.png',
                                      'result_cnn_3first_layer_50_10_0.5/'+str(i)+'-first_layer.png']
              ]
    widths, heights = zip(*(i.size for i in images))

    total_width = sum(widths)
    max_height = max(heights)

    new_im = Image.new('RGB', (total_width, max_height))

    x_offset = 0
    for im in images:
      new_im.paste(im, (x_offset,0))
      x_offset += im.size[0]

    new_im.save('comparision/comparison-' + str(i) + '.png')


images = [Image.open(x) for x in ['comparision/comparison-1.png',
                                  'comparision/comparison-7.png',
                                  'comparision/comparison-12.png',
                                  'comparision/comparison-13.png',
                                  'comparision/comparison-16.png',
                                   'comparision/comparison-19.png',
                                  ]
          ]
widths, heights = zip(*(i.size for i in images))

max_width = max(widths)
total_height = sum(heights)

new_im = Image.new('RGB', (max_width, total_height))

y_offset = 0
for im in images:
    new_im.paste(im, (0, y_offset))
    y_offset += im.size[1]

new_im.save('comparision/comparison_all.png')

